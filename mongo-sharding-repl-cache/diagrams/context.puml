@startuml C4_Context
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title Контекстная диаграмма MongoDB Sharding с репликацией и кешированием

Person(user, "Пользователь", "Пользователь системы")

System_Boundary(mongo_system, "MongoDB Sharding System") {
    System(mongos, "MongoDB Router", "MongoDB Router (mongos) для маршрутизации запросов")
    System(configsvr, "Config Server", "Config Server для хранения метаданных")
    System(shard1, "Shard1", "Первый шард с репликацией")
    System(shard2, "Shard2", "Второй шард с репликацией")
    System(redis, "Redis", "Redis для кеширования")
    System(api, "API Application", "FastAPI приложение для работы с данными")
}

Rel(user, api, "Использует")
Rel(api, mongos, "Отправляет запросы")
Rel(mongos, configsvr, "Получает метаданные")
Rel(mongos, shard1, "Маршрутизирует запросы")
Rel(mongos, shard2, "Маршрутизирует запросы")
Rel(api, redis, "Кеширует данные")

@enduml 